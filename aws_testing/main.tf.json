[
  {
    "provider": {
      "aws": {
        "region": "ap-south-1"
      }
    }
  },
  {
    "resource": {
      "aws_vpc": {
        "vpc001": {
          "cidr_block": "10.0.0.0/16"
        }
      }
    }
  },
  {
    "resource": {
      "aws_subnet": {
        "subnet001": {
          "vpc_id": "${aws_vpc.vpc001.id}",
          "cidr_block": "10.0.1.0/24"
        }
      }
    }
  },
  {
    "resource": {
      "aws_route_table": {
        "routetable001": {
          "vpc_id": "${aws_vpc.vpc001.id}"
        }
      }
    }
  },
  {
    "resource": {
      "aws_default_security_group": {
        "default": {
          "vpc_id": "${aws_vpc.vpc001.id}"
        }
      }
    }
  },
  {
    "resource": {
      "aws_cloudwatch_log_group": {
        "example": {
          "name": "my-log-group",
          "retention_in_days": 7
        }
      }
    }
  },
  {
    "resource": {
      "aws_iam_role": {
        "flow-logs-role": {
          "name": "flow-logs-role",
          "assume_role_policy": jsonencode({
            "Version": "2012-10-17",
            "Statement": [
              {
                "Effect": "Allow",
                "Principal": {
                  "Service": "vpc-flow-logs.amazonaws.com"
                },
                "Action": "sts:AssumeRole"
              }
            ]
          })
        }
      }
    }
  },
  {
    "resource": {
      "aws_iam_role_policy_attachment": {
        "flow-logs-policy": {
          "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSFlowLogsServiceRolePolicy",
          "role": "${aws_iam_role.flow-logs-role.name}"
        }
      }
    }
  },
  {
    "resource": {
      "aws_flow_log": {
        "example": {
          "iam_role_arn": "${aws_iam_role.flow-logs-role.arn}",
          "log_destination": "${aws_cloudwatch_log_group.example.arn}",
          "traffic_type": "ALL",
          "vpc_id": "${aws_vpc.vpc001.id}"
        }
      }
    }
  }
]
